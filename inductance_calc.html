<!DOCTYPE html>
<html lang="en-US">

<!-- ********** HEAD ********** -->
<head>

   <title>Inductance Calculator</title>

   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=2.0">
   <meta name="keywords" content="Inductance, magnetics, coil, calculator">
   
   <meta name="description" content="JavaScript calculator of inductances with ferrite core">
   <meta name="generator" content="Picalc generator powered by Python and Jinja2">
   <meta name="version" content="10/04/2018 - SHA:2AD99E">



<!-- ********** STYLES ********** -->
<style>
   body {
      font: 16px sans-serif;
      background-color: #f0f4f4;
      margin: 0;
      min-width: 420px;
   }

   .content {
      max-width: 640px;
      margin: 0 auto;
      padding: 16px 16px 32px 16px;
      background-color: #fff;
   }

   .row {
      padding-bottom: 2px;
   }

   .footer {
      max-width: 640px;
      margin: 0 auto;
      text-align: center;
      padding: 20px 16px 60px 16px;
      font-size: 12px;
      font-weight: bold;
      background-color: #ddd;
   }

   h1 {
      font-size: 140%;
      font-weight: bold;
      text-transform: uppercase;
      margin: 20px 0 10px 0;
   }

   h2 {
      font-size: 120%;
      font-weight: bold;
      margin: 20px 0 6px 0;
   }

   img {
      padding: 2px 0 2px 0;
      max-width: 100%;
   }

   input[type=button] {
      font: inherit;
      text-align: center;
      background-color: #eee;
      border: 1px solid #888;
      border-radius: 4px;
   }

   /* Column 1: Variable name */
   .sname {
      display: inline-block;
      min-width: 5em;
   }

   /* Column 2: Variable Value (input form) */
   input[type=text], select, textarea {
      width: 100%;
      padding: 1px 4px 0 4px;
      height: 22px;
      font: inherit;
      text-align: right;
      box-sizing: border-box;
      border: 1px solid #888;
      border-radius: 4px;
   }
    input[type=text]:disabled {
      color: inherit;
   }

   .ssel {
      display: inline-block;
      width: 11.0em;
   }

   .sval {
      display: inline-block;
      width: 6em;
   }
   .sval input[type=text] {
      background-color: #FFFFC0;
   }

   .sconst {
      display: inline-block;
      width: 6em;
   }
   .sconst input[type=text] {
      background-color: #FFFFFF;
   }

   .scalc  {
      display: inline-block;
      width: 6em;
   }
   .scalc input[type=text] {
      background-color: #C0FFFF;
   }

   /* Column 3: Variable Units */
   .sunit {
      display: inline-block;
      min-width: 5em;
      text-align: center;
      border: 1px solid #888;
      border-radius: 4px;
   }

   /* Column 4: Variable comment */
   .scoment {
      display: inline-block;
      min-width: 20em;
   }
</style>


<!-- ********** SCRIPTS ********** -->
<script>


   // Global variables and backup
   var Ae;  // Effective magnetic cross section
   var B_max;  // Max value of magnetic flux density
   var AL;  // Inductance factor (permeability)
   var uo;  // Permeability of air
   var ro_cu;  // Resistivity of copper at 20ºC
   var Cro_cu;  // Coefficient of resistivity of copper with temperature
   var g;  // Air gap length
   var g_factor;  // Relative length of air gap (g/√Ae)
   var Fr_factor;  // Fringing factor of air gap (+-15% error)
   var AL_gap;  // Inductance factor (permeability) of air gap
   var AL_total;  // Total Inductance factor with gap
   var AL_2;  // Inductance factor (permeability)
   var N;  // Number of winding turns
   var L;  // Coil Inductance
   var I_max;  // Maximum Inductor Current
   var E_max;  // Energy stored in Inductance
   var f;  // Frequency
   var T;  // Period
   var V_sin;  // Maximum sine wave voltage
   var V_sq;  // Maximum square wave voltage
   var variables_backup = {}; // Global variables values backup

   // Global variables properties
   var _prefix = {
     "Ae":  1e-06,
     "B_max":  1e-03,
     "AL":  1e-09,
     "uo":  1.0,
     "ro_cu":  1.0,
     "Cro_cu":  1.0,
     "g":  1e-03,
     "g_factor":  1e-02,
     "Fr_factor":  1.0,
     "AL_gap":  1e-09,
     "AL_total":  1e-09,
     "AL_2":  1e-09,
     "N":  1.0,
     "L":  1e-06,
     "I_max":  1.0,
     "E_max":  1e-06,
     "f":  1e+03,
     "T":  1e-06,
     "V_sin":  1.0,
     "V_sq":  1.0,
   };

   // Calculate formulas and print values
   function calc() {
      var_backup();
      query_write();

      // Constant: Permeability of air
      uo = ( 1.2566e-6 ) *  1.0;

      // Constant: Resistivity of copper at 20ºC
      ro_cu = ( 17.24e-9 ) *  1.0;

      // Constant: Coefficient of resistivity of copper with temperature
      Cro_cu = ( 0.00393 ) *  1.0;

      // Calculation: Relative length of air gap (g/√Ae)
      g_factor = g / Math.sqrt(Ae);

      // Calculation: Fringing factor of air gap (+-15% error)
      Fr_K1 = 2.15;
      Fr_K2 = 0.74;
      Fr_factor = 1 + Fr_K1 * Math.pow(g_factor, Fr_K2);

      // Calculation: Inductance factor (permeability) of air gap
      AL_gap = uo * Ae * Fr_factor / g;

      // Calculation: Total Inductance factor with gap
      AL_total = 1.0 / ( (1.0 / AL_gap) + (1.0 / AL) );

      // Calculation: Coil Inductance
      L = AL_2 * Math.pow(N, 2);

      // Calculation: Maximum Inductor Current
      I_max = (Ae * B_max) / (AL * N);

      // Calculation: Energy stored in Inductance
      E_max = 0.5 * Math.pow(I_max, 2) * L;

      // Calculation: Period
      T = 1.0 / f;

      // Calculation: Maximum sine wave voltage
      V_sin = I_max * (2 * Math.PI * f) * L / Math.sqrt(2);

      // Calculation: Maximum square wave voltage
      T = 1.0 / f;
      V_sq = L * I_max * 2 / ( T / 2.0 );

      // Print variables and calcs
      print_calc();
   }

   // Print calcs
   function print_calc() {
      document.getElementById("g_factor").value = num_float(g_factor *  1e+02, 5);
      document.getElementById("Fr_factor").value = num_float(Fr_factor *  1.0, 5);
      document.getElementById("AL_gap").value = num_float(AL_gap *  1e+09, 5);
      document.getElementById("AL_total").value = num_float(AL_total *  1e+09, 5);
      document.getElementById("L").value = num_float(L *  1e+06, 5);
      document.getElementById("I_max").value = num_float(I_max *  1.0, 5);
      document.getElementById("E_max").value = num_float(E_max *  1e+06, 5);
      document.getElementById("T").value = num_float(T *  1e+06, 5);
      document.getElementById("V_sin").value = num_float(V_sin *  1.0, 5);
      document.getElementById("V_sq").value = num_float(V_sq *  1.0, 5);
      document.getElementById("uo").value = "1.2566e-6";
      document.getElementById("ro_cu").value = "17.24e-9";
      document.getElementById("Cro_cu").value = "0.00393";
   }

   // Read variables from html
   function var_read_id() {
      Ae = idtonum("Ae") *  1e-06; // Variable: Effective magnetic cross section
      B_max = idtonum("B_max") *  1e-03; // Variable: Max value of magnetic flux density
      AL = idtonum("AL") *  1e-09; // Variable: Inductance factor (permeability)
      g = idtonum("g") *  1e-03; // Variable: Air gap length
      AL_2 = idtonum("AL_2") *  1e-09; // Variable: Inductance factor (permeability)
      N = idtonum("N") *  1.0; // Variable: Number of winding turns
      f = idtonum("f") *  1e+03; // Variable: Frequency
   }

   // Write variables
   function var_write(config) {
      var name;
      for(var i=0; i<config.length; i++) {
         name = config[i][0];
         if (name in _prefix) {
            window[name] = config[i][1];
         }
      }
      var_write_id();
   }

   // Reset variables to default values
   function var_reset() {
      Ae = ( 683 ) *  1e-06;
      B_max = ( 300 ) *  1e-03;
      AL = ( 8100 ) *  1e-09;
      g = ( 0 ) *  1e-03;
      AL_2 = ( AL * 1e9 ) *  1e-09;
      N = ( 10 ) *  1.0;
      f = ( 20 ) *  1e+03;
      var_write_id();
   }

   // Clear variables in html
   function var_clear() {
      Ae = '';
      B_max = '';
      AL = '';
      g = '';
      AL_2 = '';
      N = '';
      f = '';
      var_write_id();
   }

   // Test if there are any change in variables
   function var_test_change() {
      if (variables_backup["Ae"] != Ae) return true;
      if (variables_backup["B_max"] != B_max) return true;
      if (variables_backup["AL"] != AL) return true;
      if (variables_backup["g"] != g) return true;
      if (variables_backup["AL_2"] != AL_2) return true;
      if (variables_backup["N"] != N) return true;
      if (variables_backup["f"] != f) return true;
      return false;
   }

   // Copy values of variables
   function var_backup() {
      variables_backup["Ae"] = Ae;
      variables_backup["B_max"] = B_max;
      variables_backup["AL"] = AL;
      variables_backup["g"] = g;
      variables_backup["AL_2"] = AL_2;
      variables_backup["N"] = N;
      variables_backup["f"] = f;
   }

   // Write variables values to html forms
   function var_write_id() {
      var value;
      if (Ae == "") value = ""; else value = num_float(Ae / _prefix["Ae"], 5);
      document.getElementById("Ae").value = value;
      if (B_max == "") value = ""; else value = num_float(B_max / _prefix["B_max"], 5);
      document.getElementById("B_max").value = value;
      if (AL == "") value = ""; else value = num_float(AL / _prefix["AL"], 5);
      document.getElementById("AL").value = value;
      if (g == "") value = ""; else value = num_float(g / _prefix["g"], 5);
      document.getElementById("g").value = value;
      if (AL_2 == "") value = ""; else value = num_float(AL_2 / _prefix["AL_2"], 5);
      document.getElementById("AL_2").value = value;
      if (N == "") value = ""; else value = num_float(N / _prefix["N"], 5);
      document.getElementById("N").value = value;
      if (f == "") value = ""; else value = num_float(f / _prefix["f"], 5);
      document.getElementById("f").value = value;
   }

   // Select: Core
   function select_core() {
      var database = {
         "E_10_5_5": {"Le": 0.0263, "Ae": 1.09e-05, "Ve": 287e-9, },
         "E_13_7_4": {"Le": 0.0296, "Ae": 1.24e-05, "Ve": 367e-9, },
         "E_25_13_7": {"K2": -0.731, "K1": 90, "Le": 0.0575, "Ae": 5.25e-05, "Ve": 3020e-9, },
         "E_30_15_7": {"Le": 0.067, "Ae": 6e-05, "Ve": 4000e-9, },
      }
      // Read selected values
      selected_id = document.getElementById("select_core_id").value;
      data_selected = database[selected_id];
      if (!data_selected || data_selected.length == 0)
         return;
      // Copy values to variables
      for(var key in data_selected) {
         if (key in window)
            window[key] = data_selected[key];
      }
      var_write_id();
      calc();
   }

   // Reset variables to default values in html and JavaScript
   function button_reset() {
      var_reset();
      var_write_id();
      calc();
   }

   // Clear variables in html and JavaScript
   function button_clear() {
      var_clear();
      var_write_id();
      calc();
   }

   // Copy to clipboard the url + query string
   function button_url_copy() {
      query_copy();
   }

   // Write query string into url
   function query_write() {
      var url = document.location.href.split('?')[0];
      var query = '?';
      var value;
      value = encodeURIComponent(num_float(Ae, 5))
      if (value.length) query = query + "Ae=" + value + '&';
      value = encodeURIComponent(num_float(B_max, 5))
      if (value.length) query = query + "B_max=" + value + '&';
      value = encodeURIComponent(num_float(AL, 5))
      if (value.length) query = query + "AL=" + value + '&';
      value = encodeURIComponent(num_float(g, 5))
      if (value.length) query = query + "g=" + value + '&';
      value = encodeURIComponent(num_float(AL_2, 5))
      if (value.length) query = query + "AL_2=" + value + '&';
      value = encodeURIComponent(num_float(N, 5))
      if (value.length) query = query + "N=" + value + '&';
      value = encodeURIComponent(num_float(f, 5))
      if (value.length) query = query + "f=" + value + '&';
      if (query.length > 1) url = url + query
      history.pushState({id: 'picalc'}, 'Inductance Calculator', url);
   }

   // Read query string from URL
   function query_read() {
      var url = document.location.href.split('?');
      if (url.length < 2)
         return [];
      var values = url[1].split('&');
      var vars = [];
      for(i=0; i<values.length; i++) {
         var value = values[i].split('=');
         if (value.length != 2) continue;
         vars.push(value);
      }
      return vars;
   }

   // Copy url with query to clipboard
   function query_copy() {
      var textArea = document.createElement('textarea');
      textArea.value = document.location.href;
      document.body.appendChild(textArea);
      textArea.focus();
      textArea.select();
      try {
         document.execCommand('copy');
      } catch (err) {
         console.error('Oops, unable to copy url', err);
      }
      document.body.removeChild(textArea);
   }

   // Evalue inputs with '.' or ',' as comma
   function idtonum(id) {
      val = document.getElementById(id).value.replace(',', '.');
      if (isNaN(val)) return '';
      return val * 1e0; // return number
   }

   // Format number with fixed digits
   function num_float(number, digits) {
      if (!isFinite(number)) return '';
      if (number == 0) return '0';
      if (Math.sign(number) < 0)
         var sign = '-';
      else
         var sign = '';
      number = Math.abs(number)
      // Fixed point number
      if (number >= 1e-3 && number < 1e6) {
         number = Number(number.toPrecision(digits));
         number = sign + number.toString();
         return number;
      }
      // Float number
      else {
         exp = Math.floor(Math.log10(number) / 3) * 3;
         number = number * Math.pow(10, -exp);
         number = Number(number.toPrecision(digits));
         number = number.toString() + 'e' + exp.toString();
         return number;
      }
   }

   // Setup variables on page load
   function setup() {
      var config = query_read();
      if (config.length > 0) {
         var_write(config);
      }
      else {
         var_reset();
      }
      calc();
   }

   // Manage browser history
   window.onpopstate = function OnPopState(event) {
      setup();
   };

   // Manage keys [Enter] and [tab]
   document.onkeypress = function OnKeyPress(evt) {
      var evt = (evt) ? evt : ((event) ? event : null);
      var node = (evt.target) ? evt.target : ((evt.srcElement) ? evt.srcElement : null);
      if (node.type=="text") {
         if (evt.keyCode == 9) { recalc(); return; }
         if (evt.keyCode == 13) { recalc(); return false; }
      }
   }

   // Recalc values after key pressed
   function recalc() {
      var_read_id();
      if (var_test_change() == true) {
         calc();
      }
   }
</script>

</head>


<body onload="setup()">

<!-- ********** BODY CONTENT ********** -->

   <div class="content"> <!-- Start content -->

   <h1>Inductance Calculator</h1>

   <!--  Buttons: Values -->
   <div class="row">
      Values
      <input type="button" value="Reset" onclick="button_reset()">
      <input type="button" value="Clear" onclick="button_clear()">
      <input type="button" value="Copy URL" onclick="button_url_copy()">
   </div>

   <!--  Header: Core and phisical constants -->
   <h2 id="Core_and_phisical_constants">Core and phisical constants</h2>

   <!--  Row: Core  -->
   <div class="row">
      <div class="sname">Core</div>
      <select class="ssel" onchange="select_core()" id="select_core_id">
      <option value="E_10_5_5"selected="selected">E_10_5_5</option>
      <option value="E_13_7_4">E_13_7_4</option>
      <option value="E_25_13_7">E_25_13_7</option>
      <option value="E_30_15_7">E_30_15_7</option>
      </select>
      <div class="scoment">Core parameters</div>
   </div>

   <!--  Row: Ae  -->
   <div class="row">
      <div class="sname">Ae</div>
      <div class="sval"> <form> <input type="text" id="Ae"> </form> </div>
      <div class="sunit">mm<sup>2</sup></div>
      <div class="scoment">Effective magnetic cross section</div>
   </div>

   <!--  Row: B_max  -->
   <div class="row">
      <div class="sname">B_max</div>
      <div class="sval"> <form> <input type="text" id="B_max"> </form> </div>
      <div class="sunit">mT</div>
      <div class="scoment">Max value of magnetic flux density</div>
   </div>

   <!--  Row: AL  -->
   <div class="row">
      <div class="sname">AL</div>
      <div class="sval"> <form> <input type="text" id="AL"> </form> </div>
      <div class="sunit">nH/turn<sup>2</sup></div>
      <div class="scoment">Inductance factor (permeability)</div>
   </div>

   <!--  Row: uo  -->
   <div class="row">
      <div class="sname">uo</div>
      <div class="sconst"> <form> <input disabled="disabled" type="text" id="uo"> </form> </div>
      <div class="sunit">V·s/A·m</div>
      <div class="scoment">Permeability of air</div>
   </div>

   <!--  Row: ro_cu  -->
   <div class="row">
      <div class="sname">ro_cu</div>
      <div class="sconst"> <form> <input disabled="disabled" type="text" id="ro_cu"> </form> </div>
      <div class="sunit">Ohm/m</div>
      <div class="scoment">Resistivity of copper at 20ºC</div>
   </div>

   <!--  Row: Cro_cu  -->
   <div class="row">
      <div class="sname">Cro_cu</div>
      <div class="sconst"> <form> <input disabled="disabled" type="text" id="Cro_cu"> </form> </div>
      <div class="sunit">1/ºC</div>
      <div class="scoment">Coefficient of resistivity of copper with temperature</div>
   </div>

   <!--  Header: Inductance Factor with Air Gap -->
   <h2 id="Inductance_Factor_with_Air_Gap">Inductance Factor with Air Gap</h2>

   <!--  Row: g  -->
   <div class="row">
      <div class="sname">g</div>
      <div class="sval"> <form> <input type="text" id="g"> </form> </div>
      <div class="sunit">mm</div>
      <div class="scoment">Air gap length</div>
   </div>

   <!--  Row: g_factor  -->
   <div class="row">
      <div class="sname">g_factor</div>
      <div class="scalc"> <form> <input disabled="disabled" type="text" id="g_factor"> </form> </div>
      <div class="sunit">%</div>
      <div class="scoment">Relative length of air gap (g/√Ae)</div>
   </div>

   <!--  Row: Fr_factor  -->
   <div class="row">
      <div class="sname">Fr_factor</div>
      <div class="scalc"> <form> <input disabled="disabled" type="text" id="Fr_factor"> </form> </div>
      <div class="sunit">&nbsp;</div>
      <div class="scoment">Fringing factor of air gap (+-15% error)</div>
   </div>

   <!--  Row: AL_gap  -->
   <div class="row">
      <div class="sname">AL_gap</div>
      <div class="scalc"> <form> <input disabled="disabled" type="text" id="AL_gap"> </form> </div>
      <div class="sunit">nH/turn<sup>2</sup></div>
      <div class="scoment">Inductance factor (permeability) of air gap</div>
   </div>

   <!--  Row: AL_total  -->
   <div class="row">
      <div class="sname">AL_total</div>
      <div class="scalc"> <form> <input disabled="disabled" type="text" id="AL_total"> </form> </div>
      <div class="sunit">nH/turn<sup>2</sup></div>
      <div class="scoment">Total Inductance factor with gap</div>
   </div>

   <!--  Header: Inductance of coil -->
   <h2 id="Inductance_of_coil">Inductance of coil</h2>

   <!--  Row: AL  -->
   <div class="row">
      <div class="sname">AL</div>
      <div class="sval"> <form> <input type="text" id="AL_2"> </form> </div>
      <div class="sunit">nH/turn<sup>2</sup></div>
      <div class="scoment">Inductance factor (permeability)</div>
   </div>

   <!--  Row: N  -->
   <div class="row">
      <div class="sname">N</div>
      <div class="sval"> <form> <input type="text" id="N"> </form> </div>
      <div class="sunit">turns</div>
      <div class="scoment">Number of winding turns</div>
   </div>

   <!--  Row: L  -->
   <div class="row">
      <div class="sname">L</div>
      <div class="scalc"> <form> <input disabled="disabled" type="text" id="L"> </form> </div>
      <div class="sunit">uH</div>
      <div class="scoment">Coil Inductance</div>
   </div>

   <!--  Row: I_max  -->
   <div class="row">
      <div class="sname">I_max</div>
      <div class="scalc"> <form> <input disabled="disabled" type="text" id="I_max"> </form> </div>
      <div class="sunit">A</div>
      <div class="scoment">Maximum Inductor Current</div>
   </div>

   <!--  Row: E_max  -->
   <div class="row">
      <div class="sname">E_max</div>
      <div class="scalc"> <form> <input disabled="disabled" type="text" id="E_max"> </form> </div>
      <div class="sunit">uJ</div>
      <div class="scoment">Energy stored in Inductance</div>
   </div>

   <!--  Header: Maximum Voltage -->
   <h2 id="Maximum_Voltage">Maximum Voltage</h2>

   <!--  Row: f  -->
   <div class="row">
      <div class="sname">f</div>
      <div class="sval"> <form> <input type="text" id="f"> </form> </div>
      <div class="sunit">kHz</div>
      <div class="scoment">Frequency</div>
   </div>

   <!--  Row: T  -->
   <div class="row">
      <div class="sname">T</div>
      <div class="scalc"> <form> <input disabled="disabled" type="text" id="T"> </form> </div>
      <div class="sunit">us</div>
      <div class="scoment">Period</div>
   </div>

   <!--  Row: V_sin  -->
   <div class="row">
      <div class="sname">V_sin</div>
      <div class="scalc"> <form> <input disabled="disabled" type="text" id="V_sin"> </form> </div>
      <div class="sunit">V</div>
      <div class="scoment">Maximum sine wave voltage</div>
   </div>

   <!--  Row: V_sq  -->
   <div class="row">
      <div class="sname">V_sq</div>
      <div class="scalc"> <form> <input disabled="disabled" type="text" id="V_sq"> </form> </div>
      <div class="sunit">V</div>
      <div class="scoment">Maximum square wave voltage</div>
   </div>

   </div>  <!-- End content -->


<!-- ********** BODY FOOTER ********** -->

   <div class="footer">
      <!-- License -->
      This work by <a href="https://github.com/picuino/picalc">Picuino</a>
      is licensed under a
      <a rel="GPL License"
         href="http://www.gnu.org/licenses/gpl-3.0-standalone.html">
         GPL version 3 license</a>.
   </div>

</body>

</html>